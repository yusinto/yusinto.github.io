{"componentChunkName":"component---src-pages-post-template-js","path":"/launch-darkly-part-two","result":{"data":{"site":{"siteMetadata":{"blurb":"Frontend Engineer @ LaunchDarkly. Book addict and tea lover. Passionate about react graphql and making things simple and fast."}},"markdownRemark":{"html":"<p>In my <a href=\"/react-feature-toggle-launch-darkly/\">previous previous post</a>\nI introduced launch darkly as a feature toggling platform and how to use it with react redux. In this post I\nwill explain how you can further leverage the power of feature toggling with user targeting.</p>\n<h2 id=\"whats-user-targeting\"><a href=\"#whats-user-targeting\" aria-label=\"whats user targeting permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What's user targeting?</h2>\n<p>You have a feature or functionality you only want to display to a select group of audience. For example\nreleasing a beta feature to users who have signed up. Kinda like a sneak preview for early adopters.\nOr perhaps you want to show special offers only to premium members of your website. This is user targeting.</p>\n<h2 id=\"ok-sounds-interesting-how-do-i-do-it\"><a href=\"#ok-sounds-interesting-how-do-i-do-it\" aria-label=\"ok sounds interesting how do i do it permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ok sounds interesting. How do I do it?</h2>\n<p>On init, you'll need to pass a user object to Launch Darkly so it has something to work with: </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> ldClient <span class=\"token keyword\">from</span> <span class=\"token string\">'ldclient-js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Launch Darkly supports the following user attributes by default</span>\n<span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n   key<span class=\"token punctuation\">:</span> <span class=\"token string\">'some-unique-key'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// mandatory, the only mandatory property</span>\n   ip<span class=\"token punctuation\">:</span> <span class=\"token string\">'111.222.3.4'</span><span class=\"token punctuation\">,</span>\n   email<span class=\"token punctuation\">:</span> <span class=\"token string\">'some@email.com'</span><span class=\"token punctuation\">,</span>\n   name<span class=\"token punctuation\">:</span> <span class=\"token string\">'React Junkie'</span><span class=\"token punctuation\">,</span>\n   firstName<span class=\"token punctuation\">:</span> <span class=\"token string\">'React'</span><span class=\"token punctuation\">,</span>\n   lastName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Junkie'</span><span class=\"token punctuation\">,</span>\n   country<span class=\"token punctuation\">:</span> <span class=\"token string\">'Australia'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nldClient<span class=\"token punctuation\">.</span><span class=\"token function\">initialize</span><span class=\"token punctuation\">(</span><span class=\"token string\">'your/client/side/id'</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You'll need to pass a user object containing at least a key property to Launch Darkly.</p>\n<h2 id=\"configure-the-dashboard\"><a href=\"#configure-the-dashboard\" aria-label=\"configure the dashboard permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configure the dashboard</h2>\n<p>Login to Launch Darkly and in the Feature Flags section select a feature flag. In the targeting section,\nyou can target individual users, use rules to target a group of users or default to a blanket rule for\nall users.</p>\n<p>I will delve into using rules to target a group of users because I think that's a more common use case\ncompared to targeting individual users.</p>\n<p>For example, the settings below will target users in Australia:</p>\n<img alt=\"Targeting user by country?\" src=\"/static/user_targeting_by_country-75b784f592576e23cc931cce05d8084f.png\" id=\"markdownImage\"/>\n<p>You can also serve true to a percentage of Australian users using the \"percentage rollout\" serve option.\nFor example the settings below will rollout true to 50% of Australian users:</p>\n<img alt=\"Targeting user by country percentage rollout?\" src=\"/static/user_targeting_percentage_rollout-5c8a23d810a5429989d1fde3b02c53af.png\" id=\"markdownImage\"/>\n<h3 id=\"advanced-targeting\"><a href=\"#advanced-targeting\" aria-label=\"advanced targeting permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Advanced targeting</h3>\n<p>If you look carefully there's an Advanced option if you select percentage rollout. The purpose of this\noption is not very obvious. In our example above you can use this advanced option to further group\nAustralian users by (say) their browser.</p>\n<p>For example, the settings below will serve true to half of chrome users, half of safari users,\nhalf of firefox users, etc. It's a way of \"bucketing\" your users so each bucket receives the\npercentage rollout you specified.</p>\n<img alt=\"Targeting user by country percentage rollout?\" src=\"/static/user_targeting_advanced-03f7439a4d9a93756f445a7a1b34af85.png\" id=\"markdownImage\"/>\n<h2 id=\"usage-with-ld-redux\"><a href=\"#usage-with-ld-redux\" aria-label=\"usage with ld redux permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage with ld-redux</h2>\n<p>If you use <a href=\"https://github.com/yusinto/ld-redux\" target=\"_blank\" rel=\"nofollow\">ld-redux</a>, you pass the user object\nas the third parameter to ldRedux.init method:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> createStore <span class=\"token keyword\">from</span> <span class=\"token string\">'&lt;your-project>/store'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ldRedux <span class=\"token keyword\">from</span> <span class=\"token string\">'ld-redux'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// standard redux createStore</span>\n<span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n   key<span class=\"token punctuation\">:</span> <span class=\"token string\">'some-unique-key'</span><span class=\"token punctuation\">,</span>\n   ip<span class=\"token punctuation\">:</span> <span class=\"token string\">'111.222.3.4'</span><span class=\"token punctuation\">,</span>\n   email<span class=\"token punctuation\">:</span> <span class=\"token string\">'some@email.com'</span><span class=\"token punctuation\">,</span>\n   name<span class=\"token punctuation\">:</span> <span class=\"token string\">'React Junkie'</span><span class=\"token punctuation\">,</span>\n   firstName<span class=\"token punctuation\">:</span> <span class=\"token string\">'React'</span><span class=\"token punctuation\">,</span>\n   lastName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Junkie'</span><span class=\"token punctuation\">,</span>\n   country<span class=\"token punctuation\">:</span> <span class=\"token string\">'Australia'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Pass the user object after store to the init method</span>\nldRedux<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token string\">'yourClientSideId'</span><span class=\"token punctuation\">,</span> store<span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Provider</span></span> <span class=\"token attr-name\">store</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>store<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Router</span></span> <span class=\"token attr-name\">routes</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>routes<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">history</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>browserHistory<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Provider</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'reactDiv'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>By default, if you don't specify a user object, ld-redux will create a default\nuser like below:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">user <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n   key<span class=\"token punctuation\">:</span> uuid<span class=\"token punctuation\">.</span><span class=\"token function\">v4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n   ip<span class=\"token punctuation\">:</span> ip<span class=\"token punctuation\">.</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n   custom<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        browser<span class=\"token punctuation\">:</span> userAgentParser<span class=\"token punctuation\">.</span><span class=\"token function\">getResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>browser<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n        device<span class=\"token punctuation\">,</span> <span class=\"token comment\">// either mobile, tablet or desktop</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You can see the complete logic for default user creation <a href=\"https://github.com/yusinto/ld-redux/blob/master/src/init.js\" target=\"_blank\" rel=\"nofollow\">here</a>.</p>\n<p>The custom property allows you to pass any arbitrary properties to Launch Darkly which you can use for targeting. This is very useful and powerful.</p>\n<h2 id=\"conclusion\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>Feature flagging coupled with user targeting is a powerful way to control your target audience. This opens up a whole\nnew world of possibilities in regards to what you can do with your app. Someday all apps will be built this way.</p>\n<p>Check out <a href=\"https://github.com/yusinto/ld-redux\" target=\"_blank\" rel=\"nofollow\">ld-redux</a> if you haven't, and please give me some feedback if you use it! Thanks.</p>\n<hr>","timeToRead":3,"frontmatter":{"date":"November 01, 2016","path":"/launch-darkly-part-two","title":"Targeting users with React Redux and Launch Darkly","files":[{"name":"user_targeting_by_country","publicURL":"/static/user_targeting_by_country-75b784f592576e23cc931cce05d8084f.png"},{"name":"user_targeting_percentage_rollout","publicURL":"/static/user_targeting_percentage_rollout-5c8a23d810a5429989d1fde3b02c53af.png"},{"name":"user_targeting_advanced","publicURL":"/static/user_targeting_advanced-03f7439a4d9a93756f445a7a1b34af85.png"}],"tags":["targeting","users","react","redux","feature","toggle","launch","darkly","toggling","ld-redux"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}
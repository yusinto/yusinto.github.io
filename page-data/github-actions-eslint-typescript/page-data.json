{"componentChunkName":"component---src-pages-post-template-js","path":"/github-actions-eslint-typescript","result":{"data":{"site":{"siteMetadata":{"blurb":"Frontend Engineer @ LaunchDarkly. Book addict and tea lover. Passionate about react graphql and making things simple and fast."}},"markdownRemark":{"html":"<p>I discovered the true power of github actions 2 weeks ago when starting a new project at work. Prior to this,\nI have been using circleci to run my linting, typescript check, tests and then deployment. I was happy with\nthis setup but was keen to learn what github actions have to offer. I was pleasantly suprised with the results.</p>\n<p>Now I see linting and typescript errors <i>in the PR</i> in the UI! I no longer have to context jump\nto another tool to check build failures, which is a huge win. Check my <a href=\"https://github.com/yusinto/github-actions-demo/pull/1/files\" target=\"_blank\" rel=\"nofollow\">demo repo</a>\nto see this in action (excuse the pun). </p>\n<p>The way github actions is setup is similar with circleci.</p>\n<h2 id=\"step-1-create-mainyml\"><a href=\"#step-1-create-mainyml\" aria-label=\"step 1 create mainyml permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 1: Create main.yml</h2>\n<p>At the root of your repo for e.g: <code class=\"language-text\">projectRoot/.github/workflows/main.yml</code> create the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>push<span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">lint</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Run eslint\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v1\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'13.x'</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn lint\n  <span class=\"token key atrule\">tsc</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Check typescript\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v1\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'13.x'</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn tsc</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>A workflow consists of jobs. A job consists of steps. Each job runs in its own docker container.</p>\n<p>You might wonder why I have 2 jobs here instead of 1. The reason is speed. Jobs are run in parallel by default\nso it could be faster to run some steps in parallel like linting and tsc. In the case where a job needs to depend\non another you can use the needs keyword:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\">  <span class=\"token key atrule\">jest</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Run tests\n    <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>lint<span class=\"token punctuation\">,</span> tsc<span class=\"token punctuation\">]</span> <span class=\"token comment\"># ensure tests are run only after eslint and tsc pass</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v1\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'13.x'</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn test</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"step-2-commit-and-push-the-yml-file\"><a href=\"#step-2-commit-and-push-the-yml-file\" aria-label=\"step 2 commit and push the yml file permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 2: Commit and push the yml file</h2>\n<p>And wait. Github will schedule your workflow to run at some point. In my experience this has been\nfast, but there is one time when I had to make an extra push on a non-master branch to initiate\ngithub actions.</p>\n<p>That's it! Now if you submit a PR you will be able to see linting and typescript errors in the UI itself:</p>\n<p align=\"center\">\n<img src=\"https://user-images.githubusercontent.com/1593077/70263065-6358bc80-174a-11ea-8e62-aadb6de7a1fb.png\" alt=\"Linting with github actions\" />\n</p>\n<p>Nice!</p>\n<h2 id=\"summary\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h2>\n<p>I love github actions. It provides immediate compile and build feedback in the UI without having to context\nchange to another tool. It's easy to setup and it's fast. There is a marketplace offering many custom actions\nyou can include in your workflow. Some of the interesting ones are <a href=\"https://github.com/marketplace/actions/jest-code-coverage-report\" target=\"_blank\" rel=\"nofollow\">jest code coverage</a>,\n<a href=\"https://github.com/marketplace/size-plugin\" target=\"_blank\" rel=\"nofollow\">size-plugin</a> and <a href=\"https://github.com/marketplace/pull-request-size\" target=\"_blank\" rel=\"nofollow\">pull-request-size</a>.</p>\n<p>There are still issues though. The marketplace actions are mostly un-verified which mean they could be\nbuggy and unmaintained. Going with a verified action is best but no guarantee that things are bug free. For\nexample I find the <a href=\"https://github.com/yusinto/github-actions-demo/pull/1/files#r354480279\" target=\"_blank\" rel=\"nofollow\">typescript line number annotation</a>\nin my demo PR is wrong. The pricing is also something you might want to consider. Github actions are free\nfor public repos but are priced according to minutes for private repos. The free tier for private repos\nincludes 2000 minutes per month.</p>\n<p>All the code in this post are in the <a href=\"https://github.com/yusinto/github-actions-demo/pull/1/files\" target=\"_blank\" rel=\"nofollow\">demo repo</a>.</p>\n<p>Thanks for reading!</p>\n<hr>","timeToRead":3,"frontmatter":{"date":"December 05, 2019","path":"/github-actions-eslint-typescript","title":"Using github actions with eslint and typescript","files":[{"name":"hero","publicURL":"/static/hero-c1e175465f133ef5b888e51a73dca4c1.png"}],"tags":["github","actions","eslint","typescript","linting","ts","react","javascript","continuous","integration","ci"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}